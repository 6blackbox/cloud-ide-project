"use client";import { useEffect, useRef } from "react";import { Terminal as XTerminal } from "@xterm/xterm";import { FitAddon } from "@xterm/addon-fit";import { Eraser, TerminalSquare } from "lucide-react"; import "@xterm/xterm/css/xterm.css";export default function Terminal({ socket, themeMode = 'dark' }) {  const terminalRef = useRef(null);  const xtermInstance = useRef(null);  const fitAddonRef = useRef(null);   const themes = {    dark: { background: '#00000000', foreground: '#e4e4e7', cursor: '#6366f1', selection: '#6366f140' },    light: { background: '#ffffff00', foreground: '#18181b', cursor: '#4f46e5', selection: '#4f46e540' }  };  const clearTerminal = () => {    if (xtermInstance.current) xtermInstance.current.clear();  };  useEffect(() => {    if (!terminalRef.current || xtermInstance.current) return;    const term = new XTerminal({      theme: themes[themeMode] || themes.dark,      fontSize: 13,      fontFamily: "'JetBrains Mono', 'Fira Code', monospace",      cursorBlink: true,      rows: 20,      allowTransparency: true,    });    const fitAddon = new FitAddon();    term.loadAddon(fitAddon);    term.open(terminalRef.current);    fitAddon.fit();    fitAddonRef.current = fitAddon;     term.write(`\x1b[2mInitializing Environment...\x1b[0m\r\n`);    xtermInstance.current = term;    if (socket) {        socket.on("terminal-output", (data) => term.write(data));    }    const resizeObserver = new ResizeObserver(() => {        requestAnimationFrame(() => {            fitAddon.fit();        });    });    resizeObserver.observe(terminalRef.current);    return () => {      resizeObserver.disconnect();       term.dispose();      xtermInstance.current = null;      if (socket) socket.off("terminal-output");    };  }, [socket]);  useEffect(() => {    if (xtermInstance.current) xtermInstance.current.options.theme = themes[themeMode] || themes.dark;  }, [themeMode]);  return (    <div className="h-full w-full pro-panel rounded-xl flex flex-col overflow-hidden border border-[var(--border-color)]">      <div className="h-10 px-4 border-b border-[var(--border-color)] flex items-center justify-between bg-[var(--bg-app)]">        <div className="flex items-center gap-2 text-[var(--text-muted)]">            <TerminalSquare className="w-4 h-4 text-[var(--accent)]" />            <span className="text-xs font-bold tracking-widest font-mono">CONSOLE</span>        </div>        <button onClick={clearTerminal} className="p-1.5 rounded-md hover:text-[var(--text-main)] transition-colors text-[var(--text-muted)]">            <Eraser className="w-3.5 h-3.5" />        </button>      </div>      <div className="flex-1 p-4 bg-[var(--bg-panel)] overflow-hidden">           <div ref={terminalRef} className="h-full w-full" />      </div>    </div>  );}